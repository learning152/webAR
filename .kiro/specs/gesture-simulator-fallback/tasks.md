# 实现计划

- [x] 1. 创建形态配置模块





  - [x] 1.1 创建 shapeConfig.ts 配置文件


    - 定义 ShapeConfig 接口
    - 创建 SHAPE_CONFIG_MAP 映射表
    - 实现 getAllShapeTypes() 函数
    - 实现 getShapeConfig() 函数（带默认值回退）
    - _需求: 6.1, 6.2, 6.3_
  - [x] 1.2 编写属性测试：形态配置默认值回退


    - **Property 6: 形态配置默认值回退**
    - **验证: 需求 6.2, 6.3**

- [x] 2. 扩展 ThreeEngine 支持旋转和缩放控制





  - [x] 2.1 添加场景旋转方法


    - 实现 setSceneRotation(rotation: Euler)
    - 实现 addSceneRotation(delta: Euler)
    - 实现 getSceneRotation()
    - _需求: 3.1, 3.2, 3.3, 3.4_
  - [x] 2.2 添加场景缩放方法


    - 实现 setSceneScale(scale: number)
    - 实现 getSceneScale()
    - 添加缩放边界限制
    - _需求: 4.2, 4.4_
  - [x] 2.3 编写属性测试：方向键旋转变换正确性


    - **Property 3: 方向键旋转变换正确性**
    - **验证: 需求 3.1, 3.2, 3.3, 3.4, 3.5**
  - [x] 2.4 编写属性测试：缩放映射正确性


    - **Property 4: 缩放滑块值与缩放比例的映射**
    - **验证: 需求 4.2, 4.4**

- [ ] 3. 检查点 - 确保所有测试通过
  - 确保所有测试通过，如有问题请询问用户。

- [-] 4. 创建 GestureSimulator 组件



  - [x] 4.1 创建组件基础结构


    - 创建 GestureSimulator.tsx 文件
    - 创建 GestureSimulator.css 样式文件
    - 定义组件 Props 接口
    - _需求: 2.1_
  - [x] 4.2 实现形态按钮动态生成


    - 从 ShapeType 枚举动态生成按钮
    - 使用 shapeConfig 获取按钮标签和图标
    - 实现按钮点击事件处理
    - 实现当前形态高亮显示
    - _需求: 2.1, 2.2, 2.3, 2.4_
  - [x] 4.3 编写属性测试：形态按钮数量一致性


    - **Property 1: 形态按钮数量与枚举值一致**
    - **验证: 需求 2.1, 6.1**
  - [x] 4.4 编写属性测试：形态转换正确性


    - **Property 2: 形态按钮点击触发正确的形态转换**
    - **验证: 需求 2.3, 2.4**
  - [x] 4.5 实现键盘控制功能


    - 添加键盘事件监听
    - 实现方向键旋转控制
    - 支持组合键同时旋转
    - 防止在输入框中触发
    - _需求: 3.1, 3.2, 3.3, 3.4, 3.5_
  - [x] 4.6 实现缩放滑块控件


    - 添加缩放滑块 UI
    - 实现滑块值到缩放比例的映射
    - 实现平滑过渡动画
    - _需求: 4.1, 4.2, 4.3, 4.4_
  - [x] 4.7 编写属性测试：缩放平滑性



    - **Property 5: 缩放过渡平滑性**
    - **验证: 需求 4.3**

- [-] 5. 检查点 - 确保所有测试通过



  - 确保所有测试通过，如有问题请询问用户。

- [x] 6. 修改 ParticleCanvas 支持降级模式





  - [x] 6.1 重构摄像头初始化逻辑


    - 将摄像头初始化改为非阻塞
    - 添加摄像头状态管理
    - 实现降级模式标志
    - _需求: 1.1, 1.2_
  - [x] 6.2 集成 GestureSimulator 组件


    - 在摄像头失败时自动显示模拟器
    - 添加模拟器显示/隐藏按钮
    - 连接模拟器回调到引擎
    - _需求: 1.2, 5.1_
  - [x] 6.3 实现重试摄像头功能

    - 添加重试按钮 UI
    - 实现重试逻辑
    - _需求: 1.4_
  - [x] 6.4 实现手动控制优先级逻辑

    - 当模拟器活动时暂停摄像头手势检测
    - 关闭模拟器时恢复摄像头检测
    - _需求: 5.2, 5.3_
  - [x] 6.5 编写属性测试：手动控制优先级


    - **Property 7: 手动控制优先级**
    - **验证: 需求 5.2**

- [ ] 7. 检查点 - 确保所有测试通过
  - 确保所有测试通过，如有问题请询问用户。

- [x] 8. 集成测试和优化





  - [x] 8.1 编写集成测试


    - 测试降级模式完整流程
    - 测试模拟器与引擎的交互
    - _需求: 1.1, 1.2, 1.3_
  - [x] 8.2 UI 样式优化


    - 优化模拟器面板样式
    - 添加动画过渡效果
    - 确保响应式布局
    - _需求: 2.1, 4.1_

- [ ] 9. 最终检查点 - 确保所有测试通过
  - 确保所有测试通过，如有问题请询问用户。
